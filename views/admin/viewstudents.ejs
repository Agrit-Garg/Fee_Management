<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
        crossorigin="anonymous"></script>
</head>
<body>
    <body style="background-color: #FFC107;">
            <!-- required -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <script src="../public/scripts/service.js"></script>
          <!-- NAVIGATION BAR -->
          <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <div class="container-fluid">
              <a class="navbar-brand text-warning" href="/admin/homelogin"><b>FEE PORTAL</b></a>
              <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
                aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
              </button>
              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ms-auto">
                  <li class="nav-item ms-3">
                    <a class="btn btn-outline-warning" href="/admin/logout" role="button">LOGOUT</a>
                  </li>
                </ul>
              </div>
            </div>
          </nav>
          <!-- ------------------------------------------------- -->
        
          <div class="container-xl px-4 mt-4">

            <div class="row">
    
                <div class="col-xl-8">
                    <!-- Search details card-->
                    <div class="card mb-4">
                        <div class="card-header"><b>Search Details</b></div>
                        <div class="card-body">
                            <form method="POST" action="">

                                <div class="row gx-3 mb-3">
    
                                    <div class="col-md-3">
                                        <label class="small mb-1" for="inputFirstName">Admission No.</label>
                                        <input class="form-control" name="admno" value="" id="inputFirstName" type="text" placeholder="Search By AdmNo">
                                    </div>
                                    <div class="col-md-3">
                                        <label class="small mb-1" for="inputFirstName">Year</label>
                                        <!-- <input class="form-control" name="paid"  id="inputFirstName" type="text"> -->
                                        <select name="year" id="" class="form-control">
                                        <option selected value="0"></option>
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                    </select>
                                    </div>
                                    <div class="col-md-3">
                                        <label class="small mb-1" for="inputFirstName">Payment</label>
                                        <select name="status" id="0" class="form-control">
                                        <option selected value="0"></option>
                                        <option value="1">Not Paid</option>
                                        <option value="2">Partial Paid</option>
                                        <option value="3">Completely Paid</option>
                                    </select>
                                    </div>
                                    <div class="col-md-3">
                                        <label class="small mb-1" for="inputFirstName"></label>
                                        <button class="btn form-control btn-success" type="submit">SEARCH</button>
                                    </div>
                                </div>
                                <div class="row gx-3 mb-3">
                                </div>
                            </form>
                            
                                <!-- <form>
                                    <div class="row gx-3 mb-3">
                                        <div class="col-md-3">
                                            <input type="text" name="search" class="form-control" id="">
                                            <input type="submit" value="search" class="btn form-control btn-warning">
                                        </div>
                                    </div>
                                </form> -->
                                <button class="btn btn-danger" onclick="tabletoexcel()">Download Excel File</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>



        <!-- Filter Table -->
        <section class="container">

          <table class="table table-light">
            <thead>
              <tr>
                <th scope="col">Admission Number</th>
                <th scope="col">Name</th>
                <th scope="col">Email</th>
                <th scope="col">Mobile</th>
                <th scope="col">Year</th>
                <th scope="col">Total Fees</th>
                <th scope="col">Fees Due</th>
                <th scope="col">Action</th>


              </tr>
            </thead>
            <tbody>
              <!-- <tr>
                <th scope="row">1</th>
                <td>Mark</td>
                <td>Otto</td>
                <td>@mdo</td>
              </tr> -->
              <%
                if(users.length > 0){
                  for(let i=0;i<users.length;i++){
                    %>
                    <tr>
                      <td><%= users[i].admno %></td>
                      <td><%= users[i].name %></td>
                      <td><%= users[i].email %></td>
                      <td><%= users[i].mobile %></td>
                      <td><%= users[i].year %></td>
                      <td><%= users[i].totalfees %></td>
                      <td><b style="color:red"><%= users[i].feesdue %></b></td>
                      <td><a href="/admin/updatestudent?id=<%=users[i]._id%>" class="btn btn-sm btn-success" target="_blank">Update</a></td>






                    </tr>
                    <%
                  }
                }
                else{
                  %>
                  <tr>
                    <td>Data Not Found</td>
                  </tr>
                  <%
                }


              %>


            </tbody>
          </table>
        </section>
      
      
      </body>
      <script src="../public/scripts/table2excel.js"></script>
      <script>
        function tabletoexcel(){
            var table2excel = new Table2Excel();
            table2excel.export(document.querySelectorAll("table.table"));
        }
      </script>
</body>


</html>